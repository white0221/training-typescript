# 6章 高度な型
# 6.1章 ユニオン型とインターセクション型
- ユニオン型: または
- インターセクション型: かつ

## 6.1.1 ユニオン型の基本
ユニオン型は「型Tまたは型U」を表現する型。 `T | U` と表記する。

```
type Animal = {
  species: string;
};
type Human = {
  name: string;
};

type User = Animal | Human;

// このオブジェクトはAnimal型なのでUser型に代入可能
const tama: User = {
  species: "Felis silvestris catus"
};
// このオブジェクトはHuman型なのでUser型に代入可能
const white: Human = {
  name: "white"
}

// エラー
function getName(user: User): string {
  return user.name;
}
```

## 6.1.2 伝播するユニオン型

```
type Animal = {
  species: string;
  age: string;
}
type Human = {
  name: string;
  age: number;
}

type User = Animal | Human;

const tama: User = {
  species: "Felis silverstris catus",
  age: "永遠の17歳"
}

const white: User = {
  name: "white",
  age: 25
}

function showAge(user: User) {
  const age = user.age;
  console.log(age); // ageの型は string | number になる
}
```

### 6.1.3 インターセクション型
インターセクション型は「型Tでありかつ型Uでもある型」を表現する型。 `T & U` と表記する。

```
type Animal = {
  species: string;
  age: number;
}
type Human = Animal & {
  name: string;
}

const tama: Animal = {
  species: "Felies silverstris catus",
  age: 3
};
const white: Human = {
  species: "Homo sapiens sapiens",
  age: 20,
  name: "white"
}

// Human型はこちらと同義
type Human = {
  species: string;
  age: number;
  name: string;
}
```

異なるプリミティブ型同士のインターセクションでは never型が出現する。
never型とは「属する値がない型」。

```
type StringAndNumber = string & number;
```

プリミティブ型同士であれば、never型として存在するものの、オブジェクトとプリミティブ同士ではneverにならない。
今回例に上げている「Animal & string」ではnever型にはならず、インターセクション型として表示されているのがわかる。これはチェックが少し大変なため、TypeScriptコンパイラではそこまで見てくれていない、というのがある。ただし、型チェックはしっかり行われるため安全になっている。

```
// Error
const cat1: Animal & string = "cat";

// Error
const cat2: Animal & string = {
  species: "Felies silvestris catus",
  age: 3
};
```

### 6.1.4 ユニオン型とインターセクション型の表裏一体な関係

```
type Human = { name: string };
type Animal = { species: string };
function getName(human: Human) {
  return human.name;
};
function getSpecies(animal: Animal) {
  return animal.species;
};

// playgroundで型を確認する
const mysteryFunc = Math.random() < 0.5 ? getName : getSpecies;

const cat: Animal = { species: "cat" }
const black: Human = { name: "black" }
mysteryFunc(cat);   // Error
mysteryFunc(white); // Error

// Success
const white: Human & Animal = {
  name: "white",
  species: "Homo sapiens sapiens"
};
console.log(mysteryFunc(white));
```


EOF